# HwBinder IPC from client to server, and callbacks
binder_call(hal_securestorage_daemon_client, hal_securestorage_daemon_server)
binder_call(hal_securestorage_daemon_server, hal_securestorage_daemon_client)

add_hwservice(hal_securestorage_daemon_server, hal_securestorage_daemon_hwservice)
allow hal_securestorage_daemon_client hal_securestorage_daemon_hwservice:hwservice_manager find;

allow hal_securestorage_daemon hal_allocator:fd use;

allow hal_securestorage_daemon securestorage_device:dir create_dir_perms;
allow hal_securestorage_daemon securestorage_device:file create_file_perms;

allow hal_securestorage_daemon securestorage_vendor_data_file:dir create_dir_perms;
allow hal_securestorage_daemon securestorage_vendor_data_file:file create_file_perms;

allow hal_securestorage_daemon system_data_file:dir getattr;
allow hal_securestorage_daemon vendor_data_file:dir rw_file_perms;
